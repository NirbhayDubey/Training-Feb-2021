CREATE TABLE Employees1
	(EMPLOYEE_ID INT NOT NULL,
	FIRST_NAME VARCHAR(20) NOT NULL,
	LAST_NAME VARCHAR(20)NOT NULL,
	SALARY DECIMAL(10,0)NOT NULL,
	JOINING_DATE DATETIME NOT NULL,
	DEPARTMENT VARCHAR(15),
	MANAGER_ID INT )
INSERT INTO Employees1(EMPLOYEE_ID, FIRST_NAME,LAST_NAME,SALARY,JOINING_DATE,DEPARTMENT,MANAGER_ID)
VALUES(1,'John','Abraham', 1000000, '2013-JAN-01 12:00:00','Banking',NULL),
(2,'Michael','Clarke',800000,'2013-JAN-01 12:00:00', 'Insurance', 1),
(3,'Roy','Thomas',700000,'2013-FEB-01 12:00:00','Banking',1),
(4,'Tom','Jose',600000,'2013-FEB-01 12:00:00','Insurance',2),
(5,'Jerry','Pinto',650000,'2013-FEB-01 12:00:00','Insurance',3),
(6,'Philip','Mathew',750000,'2013-JAN-01 12:00:00','Servicee',3),
(7,'TestName1','123',650000,'2013-JAN-01 12:00:00','Services',2),
(8,'TestName2','Lname%',600000,'2013-FEB-01 12:00:00','Insurance',2)


CREATE TABLE INCENTIVES
	( EMPLOYEE_REF_ID INT NOT NULL,
	INCENTIVE_DATE DATETIME NOT NULL,
	INCENTIVE_AMOUNT INT NOT NULL
	)

INSERT INTO INCENTIVES(EMPLOYEE_REF_ID, INCENTIVE_DATE, INCENTIVE_AMOUNT)
VALUES (1,'2013-02-01',5000),
(2,'2013-02-01',3000),
(3,'2013-02-01',4000),
(1,'2013-01-01',4500),
(2,'2013-01-01',3500)

SELECT * FROM INCENTIVES
SELECT * FROM Employees1

SELECT * FROM Employees1 WHERE EXISTS 
(SELECT * FROM INCENTIVES WHERE INCENTIVES.EMPLOYEE_REF_ID=Employees1.EMPLOYEE_ID)
GO

SELECT * FROM Employees1 WHERE SALARY >
(SELECT SALARY FROM Employees1 WHERE FIRST_NAME LIKE 'Roy')
GO

CREATE VIEW V_EMPLOYEES
AS
SELECT E.FIRST_NAME, E.LAST_NAME,E.SALARY,E.JOINING_DATE,I.INCENTIVE_AMOUNT,I.INCENTIVE_DATE 
FROM EMPLOYEES1 E FULL JOIN INCENTIVES I ON E.EMPLOYEE_ID=I.EMPLOYEE_REF_ID
GO

SELECT * FROM V_EMPLOYEES

CREATE VIEW VIEW_2
AS
SELECT E.FIRST_NAME FROM Employees1 E JOIN INCENTIVES I 
ON E.EMPLOYEE_ID = I.EMPLOYEE_REF_ID
WHERE INCENTIVE_AMOUNT>3000;

DROP VIEW VIEW_2
SELECT * FROM VIEW_2



