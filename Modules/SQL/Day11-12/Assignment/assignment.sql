--------------------------DEPOSIT--------------------------
CREATE TABLE DEPOSIT
(
	ACTNO VARCHAR(5) PRIMARY KEY NOT NULL,
	CNAME VARCHAR(19) NOT NULL,
	BNAME VARCHAR(18) NOT NULL,
	AMOUNT INT NOT NULL,
	ADATE DATE
)
GO

INSERT INTO DEPOSIT VALUES
('100','ANIL','VRCE',1000,'1-MAR-1995'),
('101','SUNIL','AJNI',5000,'4-JAN-1996'),
('102','MEHUL','KAROLBAGH',3500,'17-NOV-1995'),
('104','MADHURI','CHANDNI',1200,'17-DEC-1995'),
('105','PRAMOD','M.G.ROAD',3000,'27-MAR-1996'),
('106','SANDIP','ANDHERI',2000,'31-MAR-1996'),
('107','SHIVANI','VIRAR',1000,'5-SEP-1995'),
('108','KRANTI','NEHRU PLACE',5000,'2-JUL-1995'),
('109','NAREN','POWAI',7000,'10-AUG-1995')
GO

--------------------------BRANCH--------------------------


CREATE TABLE BRANCH
(
	BNAME VARCHAR(18) PRIMARY KEY NOT NULL,
	CITY VARCHAR(18) NOT NULL
)
GO

INSERT INTO BRANCH VALUES
('VRCE','NAGPUR'),
('AJNI','NAGPUR'),
('KAROLBAGH','DELHI'),
('CHANDNI','DELHI'),
('DHARAMPETH','NAGPUR'),
('M.G.ROAD','BANGLORE'),
('ANDHERI','MUMBAI'),
('VIRAR','MUMBAI'),
('NEHRU PLACE','DELHI'),
('POWAI','MUMBAI')
GO

--------------------------CUSTOMER--------------------------

CREATE TABLE CUSTOMER
(
	CNAME VARCHAR(19) PRIMARY KEY,
	CITY VARCHAR(18)
)

INSERT INTO CUSTOMER VALUES
('ANIL','KOLKATA'),
('SUNIL','DELHI'),
('MEHUL','BARODA'),
('MANDHAR','PATNA'),
('MADHURI','NAGPUR'),
('PRAMOD','NAGPUR'),
('SANDIP','SURAT'),
('SHIVANI','MUMBAI'),
('KRANTI','MUMBAI'),
('NAREN','MUMBAI')
GO

--------------------------BORROW--------------------------


CREATE TABLE BORROW
(
	LOANNO VARCHAR(5) PRIMARY KEY NOT NULL,
	CNAME VARCHAR(19) FOREIGN KEY REFERENCES CUSTOMER(CNAME),
	BNAME VARCHAR(18) FOREIGN KEY REFERENCES BRANCH(BNAME),
	AMOUNT INT
)

INSERT INTO BORROW VALUES
('201','ANIL','VRCE',1000),
('206','MEHUL','AJNI',5000),
('311','SUNIL','DHARAMPETH',3000),
('321','MADHURI','ANDHERI',2000),
('375','PRAMOD','VIRAR',8000),
('481','KRANTI','NEHRU PLACE',3000)
GO

ALTER TABLE DEPOSIT
ADD FOREIGN KEY(CNAME) REFERENCES CUSTOMER(CNAME);
GO
ALTER TABLE DEPOSIT
ADD FOREIGN KEY(BNAME) REFERENCES BRANCH(BNAME);
GO

SELECT * FROM DEPOSIT
GO
SELECT * FROM BRANCH
GO
SELECT * FROM CUSTOMER
GO
SELECT * FROM BORROW
GO


CREATE PROCEDURE PROCUSTOMER1 @CNAME VARCHAR(19) = 'NAREN'
AS
SELECT D.CNAME,C.CITY FROM DEPOSIT D JOIN CUSTOMER C ON D.CNAME=C.CNAME
WHERE C.CITY =
(SELECT CITY FROM CUSTOMER WHERE CNAME=@CNAME)
GO

EXEC PROCUSTOMER1
GO

CREATE PROCEDURE PROCUSTOMER3 @CITY VARCHAR(19) = 'MUMBAI'
AS
SELECT COUNT(CITY) FROM CUSTOMER WHERE CITY=@CITY
GO

EXEC PROCUSTOMER3
GO


SELECT COUNT(C.CITY) FROM BRANCH B JOIN CUSTOMER C ON B.CITY=C.CITY
GROUP BY B.CITY HAVING 
GO

--EXEC PROCUSTOMER5
GO

DROP PROCEDURE PROCUSTOMER5
GO

